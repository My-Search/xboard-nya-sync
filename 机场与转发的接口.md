# XBoard æœºåœºä¸ Nya è½¬å‘æœåŠ¡ API æ–‡æ¡£

**æ–‡æ¡£è¯´æ˜**ï¼š

  * **Base URL (æœºåœº)**: `https://xboardæœºåœºåŸŸå` (åœ¨è„šæœ¬ä¸­è®°ä¸º `${Airport_Url}`)
  * **Base URL (è½¬å‘)**: `https://nyaè½¬å‘ç½‘ç«™åŸŸå` (åœ¨è„šæœ¬ä¸­è®°ä¸º `${Forward_Url}`)
  * **æ•°æ®æ ¼å¼**: å¤šæ•°æ¥å£æ¥å—/è¿”å› JSONï¼Œä½†éƒ¨åˆ†æœºåœºæ¥å£ä½¿ç”¨ `application/x-www-form-urlencoded`ã€‚

-----

## 1\. æœºåœºç«¯æ¥å£ (XBoard)

### 1.1 ç®¡ç†å‘˜ç™»å½•

è·å–ç”¨äºåç»­è¯·æ±‚çš„æˆæƒ Tokenã€‚

  * **URL**: `/api/v1/passport/auth/login`
  * **Method**: `POST`
  * **Content-Type**: `application/x-www-form-urlencoded`
  * **è¯·æ±‚å‚æ•°**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | æè¿° |
| :--- | :--- | :--- | :--- |
| `email` | String | æ˜¯ | ç®¡ç†å‘˜é‚®ç®± |
| `password` | String | æ˜¯ | ç™»å½•å¯†ç  |

  * **å“åº”ç¤ºä¾‹**:

<!-- end list -->

```json
{
    "status": "success",
    "message": "æ“ä½œæˆåŠŸ",
    "data": {
        "token": "a89797f988...", // Session Token
        "is_admin": 1,
        "auth_data": "eyJ0eXAiOiJKV1Qi..." // JWT Token (åç»­æ¥å£ä½¿ç”¨æ­¤å€¼)
    }
}
```

> [cite_start]**æ³¨æ„**: åç»­æ¥å£ header ä¸­çš„ `authorization` å­—æ®µéœ€ä½¿ç”¨å“åº”ä¸­çš„ `data.auth_data` å€¼ [cite: 1]ã€‚

### 1.2 è·å–èŠ‚ç‚¹åˆ—è¡¨

è·å–å½“å‰æœºåœºæ‰€æœ‰èŠ‚ç‚¹çš„ä¿¡æ¯ã€‚

  * **URL**: `/api/v1/sysadmin/server/manage/getNodes`
  * **Method**: `GET`
  * **Headers**:
      * `authorization`: `{{auth_data}}`
  * **å“åº”ç¤ºä¾‹**:

<!-- end list -->

```json
{
    "status": "success",
    "data": [
        {
            "id": 37,
            "name": "ğŸ‡¯ğŸ‡µæ—¥æœ¬1",
            "host": "125.77.160.35", // å½“å‰èŠ‚ç‚¹IP/åŸŸå
            "port": "20001",       // è¿æ¥ç«¯å£
            "type": "shadowsocks", // èŠ‚ç‚¹ç±»å‹
            "group_id": ["1", "2", "3"], // æƒé™ç»„IDæ•°ç»„
            "route_id": null,
            "parent_id": null,
            ...
        }
    ]
}
```

### 1.3 ä¿®æ”¹ Shadowsocks èŠ‚ç‚¹ä¿¡æ¯

ç”¨äºæ›´æ–°èŠ‚ç‚¹çš„ IPã€ç«¯å£æˆ–å…¶ä»–é…ç½®ï¼ˆè„šæœ¬ä¸»è¦ç”¨äºåŒæ­¥è½¬å‘åçš„ IP å’Œç«¯å£ï¼‰ã€‚

  * **URL**: `/api/v1/sysadmin/server/shadowsocks/save`
  * **Method**: `POST`
  * **Content-Type**: `application/x-www-form-urlencoded`
  * **Headers**:
      * `authorization`: `{{auth_data}}`
  * **å…³é”®è¯·æ±‚å‚æ•°**:

| å‚æ•°å | æè¿° | ç¤ºä¾‹å€¼ |
| :--- | :--- | :--- |
| `id` | èŠ‚ç‚¹ ID | `37` |
| `name` | èŠ‚ç‚¹åç§° | `ğŸ‡¯ğŸ‡µæ—¥æœ¬1` |
| `host` | **[æ ¸å¿ƒ]** æ–°çš„ä¸»æœºåœ°å€ (è½¬å‘å…¥å£IP) | `103.181.165.140` |
| `port` | **[æ ¸å¿ƒ]** æ–°çš„è¿æ¥ç«¯å£ | `20001` |
| `server_port` | æœåŠ¡ç«¯ç›‘å¬ç«¯å£ | `20001` |
| `group_id[0]` | æƒé™ç»„ ID (æ•°ç»„æ ¼å¼ä¼ è¾“) | `1` |
| `group_id[1]` | æƒé™ç»„ ID | `2` |
| `cipher` | åŠ å¯†æ–¹å¼ | `chacha20-ietf-poly1305` |
| `rate` | å€ç‡ | `1` |
| `online` | åœ¨çº¿çŠ¶æ€ | `1` |
| `available_status` | å¯ç”¨çŠ¶æ€ | `1` |

> [cite_start]**æç¤º**: `group_id` å‚æ•°éœ€ä»¥æ•°ç»„ä¸‹æ ‡å½¢å¼ä¼ é€’ï¼Œä¾‹å¦‚ `group_id[0]=1&group_id[1]=2` [cite: 34]ã€‚

-----

## 2\. è½¬å‘ç«¯æ¥å£ (Nya)

### 2.1 ç”¨æˆ·ç™»å½•

è·å–ç”¨äºç®¡ç†è½¬å‘è§„åˆ™çš„ Tokenã€‚

  * **URL**: `/api/v1/auth/login`
  * **Method**: `POST`
  * **Content-Type**: `text/plain;charset=UTF-8` (å®é™…å‘é€çš„æ˜¯ JSON å­—ç¬¦ä¸²)
  * **è¯·æ±‚ Body**:

<!-- end list -->

```json
{
    "username": "user@example.com",
    "password": "your_password"
}
```

  * **å“åº”ç¤ºä¾‹**:

<!-- end list -->

```json
{
    "code": 0,
    "data": "f9f0e0a8-f957-47f6-9ff1-7b4789b803d7", // UUID Token
    "msg": "ç™»å½•æˆåŠŸ"
}
```

> [cite_start]**æ³¨æ„**: åç»­æ¥å£ header ä¸­çš„ `Authorization` å­—æ®µç›´æ¥ä½¿ç”¨å“åº”ä¸­çš„ `data` å­—ç¬¦ä¸² [cite: 35]ã€‚

### 2.2 è·å–è½¬å‘è§„åˆ™åˆ—è¡¨

æŸ¥è¯¢ç”¨æˆ·è®¾ç½®çš„æ‰€æœ‰è½¬å‘è§„åˆ™ï¼ŒåŒ…å«ç›‘å¬ç«¯å£å’Œç»‘å®šçš„å…¥å£ç»„ IDã€‚

  * **URL**: `/api/v1/user/forward`
  * **Method**: `GET`
  * **Query å‚æ•°**:
      * `page`: `1`
      * `size`: `10` (æˆ–æ›´å¤§ï¼Œè„šæœ¬ä¸­ä½¿ç”¨ 100)
  * **Headers**:
      * `Authorization`: `{{token}}`
  * **å“åº”ç¤ºä¾‹**:

<!-- end list -->

```json
{
    "code": 0,
    "data": [
        {
            "id": 3862,
            "name": "æ—¥æœ¬01",        // è½¬å‘è§„åˆ™åç§°
            "listen_port": 20001,    // è½¬å‘ç›‘å¬ç«¯å£
            "device_group_in": 235,  // å…¥å£è®¾å¤‡ç»„ ID (å…³é”®å…³è”å­—æ®µ)
            "config": "{\"dest\":[\"47.79.42.155:20001\"]}", // è½åœ°ç›®æ ‡
            "status": "ForwardRuleStatus_Normal"
        }
    ]
}
```

### 2.3 è·å–è®¾å¤‡ç»„ (å…¥å£ IP)

æŸ¥è¯¢è½¬å‘æœåŠ¡çš„å…¥å£èŠ‚ç‚¹ä¿¡æ¯ï¼Œç”¨äºè§£æ `device_group_in` å¯¹åº”çš„å®é™…è¿æ¥ IPã€‚

  * **URL**: `/api/v1/user/devicegroup`
  * **Method**: `GET`
  * **Headers**:
      * `Authorization`: `{{token}}`
  * **å“åº”ç¤ºä¾‹**:

<!-- end list -->

```json
{
    "code": 0,
    "data": [
        {
            "id": 235,                  // å¯¹åº”è§„åˆ™ä¸­çš„ device_group_in
            "name": "IEPL2-é«˜é˜²",
            "type": "DeviceGroupType_Inbound",
            "connect_host": "125.77.160.49\nå”®åç¾¤...", // è¿æ¥åœ°å€ (å«å¹²æ‰°å­—ç¬¦)
            "port_range": "10000-50000"
        }
    ]
}
```

